
<!DOCTYPE html>
<html class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Atomist Developer Platform">
      
      
      
        <meta name="author" content="The Atomist Team">
      
      
        <link rel="shortcut icon" href="../../../images/favicon.ico">
      
      <meta name="generator" content="mkdocs-0.16.1, mkdocs-material-1.3.0">
    
    
      
        <title>Commands - The Atomist Documentation</title>
      
    
    
      <script src="../../../assets/javascripts/modernizr-56ade86843.js"></script>
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application-1d1da4857d.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-66fa0d9bba.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="green" data-md-color-accent="green">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../../.." title="The Atomist Documentation" class="md-logo md-header-nav__button">
            <img src="../../../images/atomist-logo-horiz-reversed.svg" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  User Guide
                </span>
              
                <span class="md-header-nav__parent">
                  Rug
                </span>
              
            
            Commands
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <div class="md-search__overlay"></div>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result"></div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
            


  


  <a href="https://github.com/atomist/rug" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Rug
    </div>
  </a>

          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../../../images/atomist-logo-horiz-reversed.svg">
      </i>
    
    The Atomist Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/atomist/rug" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Rug
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../capabilities/" title="Capabilities" class="md-nav__link">
      Capabilities
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/prerequisites/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/invite-atomist-to-slack/" title="Invite Atomist to Slack" class="md-nav__link">
      Invite Atomist to Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/connect-atomist-to-github/" title="Connect Atomist to GitHub" class="md-nav__link">
      Connect Atomist to GitHub
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/putting-atomist-to-work/" title="Putting Atomist to Work" class="md-nav__link">
      Putting Atomist to Work
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/connect-atomist-to-ci/" title="Connect Atomist to CI" class="md-nav__link">
      Connect Atomist to CI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/build-your-own-development-automation/" title="Build Your Own Development Automation" class="md-nav__link">
      Build Your Own Development Automation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
    
    <label class="md-nav__link" for="nav-3-2">
      Rug
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Rug
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../runtime/" title="Runtime" class="md-nav__link">
      Runtime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../typescript/" title="TypeScript" class="md-nav__link">
      TypeScript
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../handlers/" title="Handlers" class="md-nav__link">
      Handlers
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
    <a href="./" title="Commands" class="md-nav__link md-nav__link--active">
      Commands
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../editors/" title="Editors" class="md-nav__link">
      Editors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../generators/" title="Generators" class="md-nav__link">
      Generators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../reviewers/" title="Reviewers" class="md-nav__link">
      Reviewers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../extensions/" title="Extensions" class="md-nav__link">
      Extensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../path-expressions/" title="Path Expressions" class="md-nav__link">
      Path Expressions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../microgrammars/" title="Microgrammars" class="md-nav__link">
      Microgrammars
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../templates/" title="Templates" class="md-nav__link">
      Templates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tests/" title="Tests" class="md-nav__link">
      Tests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../projects/" title="Projects" class="md-nav__link">
      Projects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../archives/" title="Archives" class="md-nav__link">
      Archives
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lifecycle/" title="Lifecycle" class="md-nav__link">
      Lifecycle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../conventions/" title="Conventions" class="md-nav__link">
      Conventions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Integrations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Integrations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/slack/" title="Slack" class="md-nav__link">
      Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/github/" title="GitHub.com" class="md-nav__link">
      GitHub.com
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/travis-ci/" title="Travis CI" class="md-nav__link">
      Travis CI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/jenkins/" title="Jenkins" class="md-nav__link">
      Jenkins
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Interfaces
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Interfaces
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/bot/" title="Bot" class="md-nav__link">
      Bot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-3" type="checkbox" id="nav-3-4-3">
    
    <label class="md-nav__link" for="nav-3-4-3">
      CLI
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-3">
        CLI
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/cli/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/cli/install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/cli/using-rugs/" title="Using Rugs" class="md-nav__link">
      Using Rugs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/cli/developing-rugs/" title="Developing Rugs" class="md-nav__link">
      Developing Rugs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Reference Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Reference Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Rug
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Rug
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-2" type="checkbox" id="nav-4-2-2">
    
    <label class="md-nav__link" for="nav-4-2-2">
      Rugs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-2">
        Rugs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/rugs/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/editors/" title="Editors" class="md-nav__link">
      Editors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/generators/" title="Generators" class="md-nav__link">
      Generators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/path-expressions/" title="Path Expressions" class="md-nav__link">
      Path Expressions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-3" type="checkbox" id="nav-4-2-3">
    
    <label class="md-nav__link" for="nav-4-2-3">
      Language Extensions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-3">
        Language Extensions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/clj-project/" title="CljProject" class="md-nav__link">
      CljProject
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/c-sharp-file/" title="CSharpFile" class="md-nav__link">
      CSharpFile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/docker-file/" title="DockerFile" class="md-nav__link">
      DockerFile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/elm-module/" title="ElmModule" class="md-nav__link">
      ElmModule
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/every-pom/" title="EveryPom" class="md-nav__link">
      EveryPom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/file/" title="File" class="md-nav__link">
      File
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/java-project/" title="JavaProject" class="md-nav__link">
      JavaProject
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/java-source/" title="JavaSource" class="md-nav__link">
      JavaSource
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/java-type/" title="JavaType" class="md-nav__link">
      JavaType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/json/" title="Json" class="md-nav__link">
      Json
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/line/" title="Line" class="md-nav__link">
      Line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/pom/" title="Pom" class="md-nav__link">
      Pom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/project/" title="Project" class="md-nav__link">
      Project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/properties/" title="Properties" class="md-nav__link">
      Properties
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/python-file/" title="PythonFile" class="md-nav__link">
      PythonFile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/python-requirements-txt/" title="PythonRequirementsTxt" class="md-nav__link">
      PythonRequirementsTxt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/rug-archive-project/" title="RugArchiveProject" class="md-nav__link">
      RugArchiveProject
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/rug-file/" title="RugFile" class="md-nav__link">
      RugFile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/scala-file/" title="ScalaFile" class="md-nav__link">
      ScalaFile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/services/" title="Services" class="md-nav__link">
      Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/spring-boot-project/" title="SpringBootProject" class="md-nav__link">
      SpringBootProject
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/xml/" title="Xml" class="md-nav__link">
      Xml
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/yml/" title="Yml" class="md-nav__link">
      Yml
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-4" type="checkbox" id="nav-4-2-4">
    
    <label class="md-nav__link" for="nav-4-2-4">
      DSL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-4">
        DSL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/dsl/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/dsl/syntax/" title="Syntax" class="md-nav__link">
      Syntax
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/dsl/javascript/" title="Using JavaScript" class="md-nav__link">
      Using JavaScript
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug-cli/" title="Rug CLI" class="md-nav__link">
      Rug CLI
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#anatomy-of-a-command" title="Anatomy of a Command" class="md-nav__link">
    Anatomy of a Command
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-basic-command" title="A Basic Command" class="md-nav__link">
    A Basic Command
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Commands</h1>
                
                <p>Controlling communication and information flows is paramount to
effective teams. Open Source projects have long been relying on chat
to help them operate and coordinate contributors and project lifecycle.<br />
Recent modern chat solutions, which can integrate deeply in your ecosystem, have
improved on those foundations and proven to be fantastic hubs for teams to 
drive automation with simple chat commands.</p>
<p>Well-known scenarios drive a project&rsquo;s lifecycle, for instance cutting a new
release, or rolling back a broken deployment. However, like other Rugs, commands
can also drive into the code of the project at the tip of a bot&rsquo;s interaction.
In other words, not only can you use Rug commands to list open issues on a
project but the team can also query the project&rsquo;s code or even run other Rugs
against the project, all of this from the project&rsquo;s chat channel.</p>
<h2 id="anatomy-of-a-command">Anatomy of a Command<a class="headerlink" href="#anatomy-of-a-command" title="Permanent link">&para;</a></h2>
<p>Rug commands are the interface to add new skills to the <a href="../../interfaces/bot/">Atomist bot</a>.
These commands are suitable for when you want to either query your project
or perform an action from where your team gathers to pilot the project.</p>
<p>Depending on their goal, Rug commands are stored either along side the project
they target or in a different project altogether when they are generic. In both
cases however, Rug commands share the same approach as other Rugs. For the
purpose of this documentation, we will assume our commands live in their own
project rather than in an existing project like thie documentation describes for
Rug generators or editors.</p>
<p>Below is the basic structure of a generic Rug project. Rather than the usual
<code>.atomist/editors</code> directory, we have rather the <code>.atomist/handlers</code> directory
where our Rug command script will live.</p>
<div class="codehilite"><pre><span></span><span class="go">~/workspace/team-handlers</span>
<span class="go">    ├── .atomist</span>
<span class="go">    │   ├── .gitignore</span>
<span class="go">    │   ├── handlers</span>
<span class="go">    │   │   └── GetLatestSpringProjectTag.ts</span>
<span class="go">    │   ├── manifest.yml</span>
<span class="go">    │   ├── package.json</span>
<span class="go">    │   ├── tests</span>
<span class="go">    │   └── tsconfig.json</span>
<span class="go">    ├── CHANGELOG.md</span>
<span class="go">    ├── .gitignore</span>
<span class="go">    ├── LICENSE</span>
<span class="go">    └── README.md</span>
</pre></div>


<p>The remaining of this Rug follows the usual <a href="../projects/">Rug project</a> structure.</p>
<p>Rug commands are one kind of Rug handlers. They handle commands coming from the 
Atomist bot. Let&rsquo;s see in the section a basic Rug command.</p>
<h2 id="a-basic-command">A Basic Command<a class="headerlink" href="#a-basic-command" title="Permanent link">&para;</a></h2>
<p>Suppose we are interested in querying the <a href="http://spring.io/">Spring</a> project for the 
latest tag of any of <a href="https://github.com/spring-projects/">its published projects</a>. This would be a 
typical example of simple Rug command that we could run from the Atomist bot.</p>
<p>Here is such a possible Rug command.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">HandleResponse</span><span class="p">,</span> <span class="nx">HandleCommand</span><span class="p">,</span> <span class="nx">Response</span><span class="p">,</span> <span class="nx">HandlerContext</span><span class="p">,</span>
         <span class="nx">Plan</span><span class="p">,</span> <span class="nx">Message</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@atomist/rug/operations/Handlers&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">ResponseHandler</span><span class="p">,</span> <span class="nx">ParseJson</span><span class="p">,</span> <span class="nx">CommandHandler</span><span class="p">,</span> <span class="nx">Parameter</span><span class="p">,</span> <span class="nx">Tags</span><span class="p">,</span> 
         <span class="nx">Intent</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@atomist/rug/operations/Decorators&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">Pattern</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@atomist/rug/operations/RugOperation&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">Project</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@atomist/rug/model/Project&#39;</span><span class="p">;</span>

<span class="kd">@CommandHandler</span><span class="p">(</span><span class="s2">&quot;GetLatestSpringProjectTag&quot;</span><span class="p">,</span><span class="s2">&quot;Search for kitty snippets&quot;</span><span class="p">)</span>
<span class="kd">@Tags</span><span class="p">(</span><span class="s2">&quot;spring&quot;</span><span class="p">)</span>
<span class="kd">@Intent</span><span class="p">(</span><span class="s2">&quot;latest tag&quot;</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">GetLatestSpringProjectTag</span> <span class="kr">implements</span> <span class="nx">HandleCommand</span> <span class="p">{</span>

    <span class="kd">@Parameter</span><span class="p">({</span>
        <span class="nx">description</span><span class="o">:</span> <span class="s2">&quot;The name of a Spring repository in GitHub&quot;</span><span class="p">,</span>
        <span class="nx">pattern</span>: <span class="kt">Pattern.any</span>
    <span class="p">})</span>
    <span class="nx">repo</span>: <span class="kt">string</span><span class="p">;</span>

    <span class="nx">handle</span><span class="p">(</span><span class="nx">command</span>: <span class="kt">HandlerContext</span><span class="p">)</span><span class="o">:</span> <span class="nx">Plan</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">plan</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Plan</span><span class="p">();</span>

        <span class="kr">const</span> <span class="nx">ghUrl</span> <span class="o">=</span> <span class="sb">`https://api.github.com/repos/spring-projects/</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">repo</span><span class="si">}</span><span class="sb">/tags`</span><span class="p">;</span>

        <span class="nx">plan</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span>
            <span class="nx">instruction</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span>
                <span class="nx">kind</span><span class="o">:</span> <span class="s2">&quot;execute&quot;</span><span class="p">,</span>
                <span class="nx">parameters</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;get&quot;</span><span class="p">,</span>
                    <span class="nx">url</span>: <span class="kt">ghUrl</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nx">onSuccess</span><span class="o">:</span> <span class="p">{</span> <span class="nx">kind</span><span class="o">:</span> <span class="s2">&quot;respond&quot;</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;FetchLatestTagInfo&quot;</span> <span class="p">},</span>
            <span class="nx">onError</span><span class="o">:</span> <span class="p">{</span> <span class="nx">kind</span><span class="o">:</span> <span class="s2">&quot;respond&quot;</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;FetchedFailed&quot;</span> <span class="p">}</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="nx">plan</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kr">export</span> <span class="kd">let</span> <span class="nx">getLatestSpringProjectTag</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GetLatestSpringProjectTag</span><span class="p">();</span>


<span class="kd">@ResponseHandler</span><span class="p">(</span><span class="s2">&quot;FetchLatestTagInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;Retrieves the latest tag information&quot;</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">FetchLatestTagInfo</span> <span class="kr">implements</span> <span class="nx">HandleResponse</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="p">{</span>

    <span class="nx">handle</span><span class="p">(</span><span class="kd">@ParseJson</span> <span class="nx">response</span>: <span class="kt">Response</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span> <span class="nx">Plan</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">tagUrl</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">body</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="nx">commit</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">plan</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Plan</span><span class="p">();</span>
        <span class="nx">plan</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span>
            <span class="nx">instruction</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span>
                <span class="nx">kind</span><span class="o">:</span> <span class="s2">&quot;execute&quot;</span><span class="p">,</span>
                <span class="nx">parameters</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;get&quot;</span><span class="p">,</span>
                    <span class="nx">url</span>: <span class="kt">tagUrl</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nx">onSuccess</span><span class="o">:</span> <span class="p">{</span> <span class="nx">kind</span><span class="o">:</span> <span class="s2">&quot;respond&quot;</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;ShowTag&quot;</span> <span class="p">},</span>
            <span class="nx">onError</span><span class="o">:</span> <span class="p">{</span> <span class="nx">kind</span><span class="o">:</span> <span class="s2">&quot;respond&quot;</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;FetchedFailed&quot;</span> <span class="p">}</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="nx">plan</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kr">export</span> <span class="kd">let</span> <span class="nx">fetchLatestTagInfo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FetchLatestTagInfo</span><span class="p">();</span>


<span class="kd">@ResponseHandler</span><span class="p">(</span><span class="s2">&quot;ShowTag&quot;</span><span class="p">,</span> <span class="s2">&quot;Prints our the latest tag information&quot;</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">ShowTag</span> <span class="kr">implements</span> <span class="nx">HandleResponse</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="p">{</span>

    <span class="nx">handle</span><span class="p">(</span><span class="kd">@ParseJson</span> <span class="nx">response</span>: <span class="kt">Response</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span> <span class="nx">Message</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">body</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">body</span><span class="p">();</span> 
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Message</span><span class="p">(</span><span class="sb">`{</span>
<span class="sb">    &quot;attachments&quot;: [</span>
<span class="sb">        {</span>
<span class="sb">            &quot;fallback&quot;: &quot;&quot;,</span>
<span class="sb">            &quot;title&quot;: &quot;Latest tag&quot;,</span>
<span class="sb">            &quot;title_link&quot;: &quot;</span><span class="si">${</span><span class="nx">body</span><span class="p">.</span><span class="nx">html_url</span><span class="si">}</span><span class="sb">&quot;,</span>
<span class="sb">            &quot;fields&quot;: [</span>
<span class="sb">                {</span>
<span class="sb">                    &quot;title&quot;: &quot;Date&quot;,</span>
<span class="sb">                    &quot;value&quot;: &quot;</span><span class="si">${</span><span class="nx">body</span><span class="p">.</span><span class="nx">commit</span><span class="p">.</span><span class="nx">committer</span><span class="p">.</span><span class="nx">date</span><span class="si">}</span><span class="sb">&quot;,</span>
<span class="sb">                    &quot;short&quot;: true</span>
<span class="sb">                },</span>
<span class="sb">                {</span>
<span class="sb">                    &quot;title&quot;: &quot;Additions&quot;,</span>
<span class="sb">                    &quot;value&quot;: &quot;</span><span class="si">${</span><span class="nx">body</span><span class="p">.</span><span class="nx">stats</span><span class="p">.</span><span class="nx">additions</span><span class="si">}</span><span class="sb">&quot;,</span>
<span class="sb">                    &quot;short&quot;: true</span>
<span class="sb">                },</span>
<span class="sb">                {</span>
<span class="sb">                    &quot;title&quot;: &quot;Deletions&quot;,</span>
<span class="sb">                    &quot;value&quot;: &quot;</span><span class="si">${</span><span class="nx">body</span><span class="p">.</span><span class="nx">stats</span><span class="p">.</span><span class="nx">deletions</span><span class="si">}</span><span class="sb">&quot;,</span>
<span class="sb">                    &quot;short&quot;: true</span>
<span class="sb">                },</span>
<span class="sb">                {</span>
<span class="sb">                    &quot;title&quot;: &quot;Commit sha&quot;,</span>
<span class="sb">                    &quot;value&quot;: &quot;</span><span class="si">${</span><span class="nx">body</span><span class="p">.</span><span class="nx">sha</span><span class="si">}</span><span class="sb">&quot;,</span>
<span class="sb">                    &quot;short&quot;: false</span>
<span class="sb">                },</span>
<span class="sb">                {</span>
<span class="sb">                    &quot;title&quot;: &quot;Commit Message&quot;,</span>
<span class="sb">                    &quot;value&quot;: &quot;</span><span class="si">${</span><span class="nx">body</span><span class="p">.</span><span class="nx">commit</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">&quot;,</span>
<span class="sb">                    &quot;short&quot;: false</span>
<span class="sb">                }</span>
<span class="sb">            ]</span>
<span class="sb">        }</span>
<span class="sb">    ]</span>
<span class="sb">}`</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kr">export</span> <span class="kd">let</span> <span class="nx">showTag</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ShowTag</span><span class="p">();</span>


<span class="kd">@ResponseHandler</span><span class="p">(</span><span class="s2">&quot;FetchedFailed&quot;</span><span class="p">,</span> <span class="s2">&quot;Prints our a nice message in case of error&quot;</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">FetchedFailed</span> <span class="kr">implements</span> <span class="nx">HandleResponse</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="p">{</span>

    <span class="nx">handle</span><span class="p">(</span><span class="nx">response</span>: <span class="kt">Response</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Message</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">body</span><span class="p">();</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Message</span><span class="p">(</span><span class="sb">`Failed fetching tag information: </span><span class="si">${</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kr">export</span> <span class="kd">let</span> <span class="nx">fetchedFailed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FetchedFailed</span><span class="p">();</span>
</pre></div>
</td></tr></table>

<p>This is certainly longer than other Rugs seen so far but as it follows the 
same programming model principles, it look familiar.</p>
<p>The first lines group the Rug typing imports which, as usual, provide interfaces
and decorators to implement your Rug operations (lines 1&ndash;6). Here, the
main Rug operation is <code class="codehilite"><span class="nx">GetLatestSpringProjectTag</span></code>. The following
Rug operations, <code class="codehilite"><span class="nx">FetchLatestTagInfo</span></code>, <code class="codehilite"><span class="nx">ShowTag</span></code> and <code class="codehilite"><span class="nx">FetchedFailed</span></code> support the main one as we will see below. They are
not expected to be called directly.</p>
<p>We therefore declare our command through a TypeScript <a href="https://www.typescriptlang.org/docs/handbook/decorators.html">decorators</a> 
(line 8). The first argument of the <code class="codehilite"><span class="kd">@CommandHandler</span></code> decorator is the name of the command. This the public visible and discoverable name of the Rug. This name, along with the commands group and repository, form the fully-qualified name of the command. The second argument of the <code class="codehilite"><span class="kd">@CommandHandler</span></code> decorator is a short description of the editor. The following line uses the <code class="codehilite"><span class="kd">@Tags</span></code> decorator to apply some tags to our command so people can search for it more easily. Using the <code class="codehilite"><span class="kd">@Tags</span></code> decorator is optional but highly recommended.</p>
<p>A Rug command is associated to an intent an user sends when talking with the Atomist bot. This intent is described using the <code class="codehilite"><span class="kd">@Intent</span></code> decorator (line 10). Whenever an user sends the <code>@atomist latest tag</code> message to the Atomist bot, the Rug runtime applies the <code class="codehilite"><span class="nx">GetLatestSpringProjectTag</span></code> Rug command.</p>
<p>We then define the class which implements our command (line 11). A command 
implements the <code class="codehilite"><span class="nx">HandleCommand</span></code> interface. That interface requires the <code class="codehilite"><span class="nx">handle</span><span class="p">(</span><span class="nx">command</span>: <span class="kt">HandlerContext</span><span class="p">)</span><span class="o">:</span> <span class="nx">Plan</span></code> method to be defined (line 19). It is convention for the command and the class that implements it to have the same name.</p>
<p>Rug commands can take parameters like other Rug operations to tune their output. This customization is achieved through parameters that your command must declare in the class via the <code class="codehilite"><span class="kd">@Parameter</span></code> decorator (line 13). The decorated variable names your parameter. If you assign a value to that variable, it becomes the parameter&rsquo;s default value. The <code class="codehilite"><span class="kd">@Parameter</span></code> decorator adds additional metadata via a single argument, a JavaScript object which properties are documented in the <a href="../conventions/">conventions</a>. Though the only mandatory property is <code class="codehilite"><span class="nx">pattern</span></code>, in the case of Rug commands, it is highly recommended to also set <code class="codehilite"><span class="nx">description</span></code>, <code class="codehilite"><span class="nx">displayName</span></code> and <code class="codehilite"><span class="nx">validInput</span></code> in order to help the user when invoking the command via the Atomist bot.</p>
<p>The <code class="codehilite"><span class="nx">handle</span></code> method takes a single argument, a
<code class="codehilite"><span class="nx">HandlerContext</span></code> object. That object gives you access to a <a href="../path-expressions/">path expression engine</a> to query your project from the command. The method
must return either a <code class="codehilite"><span class="nx">Plan</span></code> or <code class="codehilite"><span class="nx">Message</span></code>.</p>
<p>Let&rsquo;s start by explaining <code class="codehilite"><span class="nx">Message</span></code> as it is the simpler. A message represents a set of presentable content and/or actions displayed to the user in responsing to invoking the command. To the bare minimum, a message is text content. By default, the message will be routed to the caller, from the place where the user issued the command. However, it is also possible to route to a different location. For instance:</p>
<div class="codehilite"><pre><span></span><span class="nx">handle</span><span class="p">(</span><span class="nx">response</span>: <span class="kt">Response</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span> <span class="nx">Message</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Message</span><span class="p">(</span><span class="s2">&quot;Hello there!&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>Next, the message is sent to a different place by setting a Slack channel identifier (we assume a Slack integration here):</p>
<div class="codehilite"><pre><span></span><span class="nx">handle</span><span class="p">(</span><span class="nx">response</span>: <span class="kt">Response</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span> <span class="nx">Message</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">message</span>: <span class="kt">Message</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Message</span><span class="p">(</span><span class="s2">&quot;Hello from a different channel!&quot;</span><span class="p">);</span>
    <span class="nx">message</span><span class="p">.</span><span class="nx">channelId</span> <span class="o">=</span> <span class="s2">&quot;C024BY98L&quot;</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">message</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>Rug command can also return a <code class="codehilite"><span class="nx">Plan</span></code>. A plan describes the actions to be taken by the Rug runtime on behalf of the command. Plans are composed of messages and/or instructions. The former are exactly as we describe above where instructions have the following properties:</p>
<ul>
<li><code class="codehilite"><span class="nx">kind</span></code>: the kind of instruction, one of <code class="codehilite"><span class="s2">&quot;generate&quot;</span> <span class="o">|</span> <span class="s2">&quot;edit&quot;</span> <span class="o">|</span> <span class="s2">&quot;review&quot;</span> <span class="o">|</span> <span class="s2">&quot;execute&quot;</span> <span class="o">|</span> <span class="s2">&quot;respond&quot;</span> <span class="o">|</span> <span class="s2">&quot;command&quot;</span></code></li>
<li><code class="codehilite"><span class="nx">name</span></code>: the name of the operation to apply</li>
<li><code class="codehilite"><span class="nx">parameters</span></code>: an object mapping properties to values and passed, by the Rug runtime, to the operation being called</li>
</ul>
<p>To make this a little more concrete, our only instruction is defined as:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span>
    <span class="nx">kind</span><span class="o">:</span> <span class="s2">&quot;execute&quot;</span><span class="p">,</span>
    <span class="nx">parameters</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;get&quot;</span><span class="p">,</span>
        <span class="nx">url</span>: <span class="kt">tagUrl</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>This instruction describes a HTTP call where the Rug function to call, by the Rug runtime, to perform that call is named <code>&quot;http&quot;</code>. At runtime, Rug will look for a Rug function named that way and will call it, passing the given <code class="codehilite"><span class="nx">parameters</span></code> to it. Here, we indicate the HTTP method is a <code>GET</code> as well as the URL to be addressed.</p>
<p>For other kinds, the definition looks similar but, in effect, a plan allows you to call any other Rug operations. This means, for example, that a command could perform a project&rsquo;s update or review at the tip of a conversation with the Atomist&rsquo;s bot.</p>
<div class="admonition important">
<p class="admonition-title">It&rsquo;s all asynchronous</p>
<p>It is important to appreciate that because Rug commands describe a plan, the actions declared in that plan are executed asynchronously from the call to your command handler method. In other words, plans are just data the Rug runtime knows how to interpret but your handler cannot invoke those actions directly. Do not make assumption regarding when instructions in a plan will be executed, although it is fair to say that the Atomist platform will do its best to apply them as soon as possible.</p>
</div>
<p>Plans can have as many interleaved instructions and messages as they need to.</p>
<p>Finally, we can attach completion (line 33) and error (line 34) handlers to each instruction to process the instruction&rsquo;s execution result. Here, we indicate we want to process the response&rsquo;s content of our HTTP call when it succeeds but also deal with errors when they occur, (for instance when the HTTP call returned a 40x-class status code).</p>
<p>The <code class="codehilite"><span class="nx">onSuccess</span></code> and <code class="codehilite"><span class="nx">onError</span></code> properties expect themselves an instruction definition. Here, we tell the Rug runtime to execute the response handlers defined below the Rug command.</p>
<p>Rug response handlers, are defined with the <code class="codehilite"><span class="nx">ResponseHandler</span></code> decorator and the class must implement the <code class="codehilite"><span class="nx">handle</span><span class="p">(</span><span class="nx">response</span>: <span class="kt">Response</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span> <span class="nx">Plan</span></code> method of the <code class="codehilite"><span class="nx">HandleResponse</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span></code> interface. When the handler receives a JSON payload, you can benefit form an automatic parsing, in that case, your method declaration must look like this: <code class="codehilite"><span class="nx">handle</span><span class="p">(</span><span class="kd">@ParseJson</span> <span class="nx">response</span>: <span class="kt">Response</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">)</span><span class="o">:</span> <span class="nx">Plan</span></code>. </p>
<p>A response handler returns a <code class="codehilite"><span class="nx">Message</span></code> or <code class="codehilite"><span class="nx">Plan</span></code> much like a Rug command. Here we can see for instance that the <code class="codehilite"><span class="nx">FetchLatestTagInfo</span></code> response handler (line 43) instructs the Rug runtime to perform another HTTP call, calling the <code class="codehilite"><span class="nx">ShowTag</span></code> response handler (line 57) to process its response. In other words, here we demonstrate how you can chain plans. The <code class="codehilite"><span class="nx">ShowTag</span></code> response handler (line 67) simply formats a final <code class="codehilite"><span class="nx">Message</span></code> returned to the user.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../handlers/" title="Handlers" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Handlers
              </span>
            </div>
          </a>
        
        
          <a href="../editors/" title="Editors" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Editors
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2017 Atomist, Inc.
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://the-composition.com/" class="md-footer-social__link fa fa-medium"></a>
    
      <a href="https://github.com/atomist" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/atomist" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://join.atomist.com/" class="md-footer-social__link fa fa-slack"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application-7aa26ad9ec.js"></script>
      <script>app.initialize({url:{base:"../../.."}})</script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-74966852-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>